<UserControl x:Class="Gomoku.Controls.PlayerCard"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:Gomoku.Controls" 
             xmlns:models="clr-namespace:Gomoku.Models" xmlns:converter="clr-namespace:Gomoku.Converter"
             
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
             TextElement.Foreground="{Binding ElementName=AppearanceElement, Path=(TextElement.Foreground)}"
             TextElement.FontWeight="Regular"
             TextElement.FontSize="13"
             TextOptions.TextFormattingMode="Ideal" 
             TextOptions.TextRenderingMode="Auto"
             Background="{DynamicResource MaterialDesignPaper}"
             FontFamily="{materialDesign:MaterialDesignFont}"
             
             
             mc:Ignorable="d" 
             d:DataContext="{d:DesignInstance Type=local:PlayerCard, IsDesignTimeCreatable=True}"
             x:Name="root">
    <UserControl.Resources>
        <converter:BoolToHiddenConverter x:Key="BoolToVis"/>
        <converter:EqualToVisibilityConverter x:Key="EqualToVis"/>
    </UserControl.Resources>
    <Grid>
        <materialDesign:Card>
            <Button Style="{StaticResource MaterialDesignFlatButton}"
                    Command="{Binding JoinGameCommand, ElementName=root}"
                    CommandParameter="{Binding TeamType, ElementName=root}"
                    HorizontalContentAlignment="Stretch" Padding="8,4">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <Ellipse x:Name="Stone" Grid.Column="0" Width="20" Height="20" Fill="{Binding StoneColor, ElementName=root}" 
                             Margin="0,0,4,0" VerticalAlignment="Center" HorizontalAlignment="Center" Stroke="Black" StrokeThickness=".3"/>
                    <TextBlock x:Name="Nickname" Grid.Column="1"
                               FontWeight="Bold" Width="100" Cursor="Hand" VerticalAlignment="Center">
                        <TextBlock.Style>
                            <Style TargetType="TextBlock" BasedOn="{StaticResource MaterialDesignBody2TextBlock}">
                                <Setter Property="Text" Value="{Binding Player.Nickname, ElementName=root}"/>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding Player, ElementName=root}" Value="{x:Null}">
                                        <Setter Property="Text" Value="{Binding PlaceHolder, ElementName=root}"/>
                                        <Setter Property="FontStyle" Value="Italic"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </TextBlock.Style>
                    </TextBlock>

                    <Button Grid.Column="2" Content="나가기" FontSize="10" Margin="5,0" Padding="4,0" VerticalAlignment="Center" Height="24"
                    Command="{Binding LeaveGameCommand}">
                        <Button.Visibility>
                            <MultiBinding Converter="{StaticResource EqualToVis}">
                                <Binding Path="TeamType" ElementName="root"/>
                                <Binding Path="Me.Type" ElementName="root"/>
                            </MultiBinding>
                        </Button.Visibility>
                    </Button>
                    <TextBlock Grid.Column="3" Text="{Binding Player.RemainingTime, ElementName=root, FallbackValue='30'}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </Grid>
            </Button>
        </materialDesign:Card>
    </Grid>
</UserControl>
